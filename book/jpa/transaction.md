---
description: 자바 ORM 표준 JPA 프로그래밍
---

# 16장. 트랜잭션과 락, 2차 캐시

## 트랜잭션과 락

### 트랜잭션과 격리 수준

트랜잭션은 ACID를 보장해야 한다. 트랜잭션은 원자성, 일관성, 지속성을 보장한다. 

* 원자성 \(Atomicity\)
  * 트랜잭션 내에서 실행한 작업들은 하나의 작업처럼 모두 성공하든가 모두 실패해야 한다.
* 일관성 \(Consistency\)
  * 모든 트랜잭션은 일관된 데이터베이스 상태를 유지해야 한다.
* 격리성 \(Isolcation\)
  * 동시에 실행되는 트랜잭션들이 서로에게 영향을 미치지 않도록 격리한다.  격리성은 동시성과 관련된 성능 이슈로 인해 격리 수준을 선택할 수 있다.
* 지속성 \(Durability\)
  * 트랜잭션을 성공적으로 끝내면 그 결과가 항상 기록되어야 한다.

격리성을 완벽히 보장하려면 트랜잭션을 거의 차례대로 실행해야 한다. 이렇게 하면 동시성 처리 성능이 매우 나빠진다.   
이런 문제로 인해 ANSI 표준은 트랜잭션의 격리 수준을 4단계로 정의했다.

| ISOLATION LEVEL | DRITY READ | NON-REPEATABLE READ | PHANTOM READ |
| :--- | :--- | :--- | :--- |
| READ UNCOMMITTED | O | O | O |
| READ COMMITTED |  | O | O |
| REPEATABLED READ |  |  | O |
| SERIALIZABLE |  |  |  |

| 격리 수준에 따른 문제점 | DESC |
| :--- | :--- |
| DRITY READ | 커밋하지 않은 데이터를 읽을 수 있다. |
| NON-REPEATABLE READ | 반복해서 같은 데이터를 읽을 수 없다. |
| PHANTOM READ | 반복 조회 시 결과 집합이 달라진다. |

격리 수준이 낮을수록 더 많은 문제가 발생하며, 격리 수준이 높을 수록 동시성 처리 성능이 급격히 떨어진다.  
애플리케이션 대부분은 동시성 처리가 중요하므로 보통 `READ COMMITTED` 격리 수준을 기본으로 사용한다.

